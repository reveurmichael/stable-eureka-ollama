def compute_reward(self, pos, action, state):
    x_pos = pos[0]
    velocity_x = state[2]
    
    reward = 1.0 - np.exp(-0.05 * ((TERRAIN_LENGTH - TERRAIN_GRASS) * TERRAIN_STEP - x_pos)**2)
    if x_pos > (TERRAIN_LENGTH - TERRAIN_GRASS) * TERRAIN_STEP:
        reward += 10.0
    elif velocity_x < 0.1:
        reward -= 5.0
    
    individual_reward = {'reach_end': reward, 'velocity': velocity_x}
    
    return float(reward), individual_reward