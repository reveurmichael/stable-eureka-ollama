def compute_reward(self, pos, action, state):
    distance_to_goal = (TERRAIN_LENGTH - TERRAIN_GRASS) * TERRAIN_STEP - pos[0]
    reward_for_moving_forward = np.exp(10 * (1.0 - abs(action[0] + action[2])))
    reward_for_reaching_goal = np.exp(-20 * distance_to_goal)
    penalty_for_falling = np.exp(-100 * int(pos[1] > 0))
    penalty_for_staying_in_place = np.exp(-5 * state[4]**2 + state[8]**2)

    total_reward = (reward_for_moving_forward + reward_for_reaching_goal) - (penalty_for_falling + penalty_for_staying_in_place)
    
    return total_reward, {'moving_forward': reward_for_moving_forward,
                          'reaching_goal': reward_for_reaching_goal,
                          'falling': penalty_for_falling,
                          'staying_in_place': penalty_for_staying_in_place}