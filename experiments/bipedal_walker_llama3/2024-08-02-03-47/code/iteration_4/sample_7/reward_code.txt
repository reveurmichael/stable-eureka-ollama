def compute_reward(self, pos, action, state):
    distance_to_end = TERRAIN_LENGTH - pos[0]
    distance_reward = np.exp(-distance_to_end / DISTANCE_TEMPERATURE) if distance_to_end > 0 else 1
    
    stability_reward = -np.sum(np.square(action)) * STABILITY_TEMPERATURE
    speed_reward = np.abs(pos[1]) * SPEED_TEMPERATURE

    fall_penalty = -FALL_PENALTY if state[-1] or state[-5] else 0
    
    individual_reward = {
        'distance': distance_reward,
        'stability': stability_reward,
        'speed': speed_reward,
        'fall': fall_penalty
    }
    
    total_reward = distance_reward + stability_reward + speed_reward - fall_penalty
    
    return total_reward, individual_reward