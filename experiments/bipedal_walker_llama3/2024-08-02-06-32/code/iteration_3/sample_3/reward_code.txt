def compute_reward(self, pos, action, state):
    distance_reached = (TERRAIN_LENGTH - TERRAIN_GRASS) * TERRAIN_STEP - pos[0]
    
    if self.game_over or pos[0] < 0:
        reward = -10.0  # penalty for game over or falling
    else:
        reward = np.exp((distance_reached / (TERRAIN_LENGTH - TERRAIN_GRASS)) * temperature)  # exponential distance reward
        
        if not self.game_over:  # if the agent hasn't reached the end yet
            reward *= 0.9 + 0.1 * (state[2] ** 2 + state[3] ** 2)  # bonus for speed and direction
            
    return np.exp(reward), {'distance': np.exp((distance_reached / (TERRAIN_LENGTH - TERRAIN_GRASS)) * temperature)}