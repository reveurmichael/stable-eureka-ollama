def compute_reward(self, pos, action, state):
    reach_end = int((pos[0] - 0) / TERRAIN_STEP)
    speed = (state[2]**2 + state[3]**2)**0.5
    fall_down = not self.hull.linearVelocity[1] > 0
    stuck = all([l.ground_contact for l in self.legs])

    reward = -10 * (reach_end < TERRAIN_LENGTH) + 20 * (not stuck or reach_end >= TERRAIN_LENGTH) - 5 * fall_down

    individual_reward = {"reaching": not (reach_end < TERRAIN_LENGTH), "stuck": not (not stuck or reach_end >= TERRAIN_LENGTH), "falling": fall_down, "speed": speed}
    return reward, individual_reward