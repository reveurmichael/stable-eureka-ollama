def compute_reward(self, pos, action, state):
    distance_to_goal = abs(pos[0] - TERRAIN_LENGTH)
    falling_penalty = max(0, self.hull.linearVelocity[1])
    
    if self.game_over:
        reward = -100.0  # Punish the agent for not reaching the goal
    elif pos[0] > (TERRAIN_LENGTH - TERRAIN_GRASS) * TERRAIN_STEP:
        reward = 100.0  # Reward the agent for reaching the end
    else:
        reward = -1.0 + 0.001 * distance_to_goal + 0.01 * falling_penalty
    
    individual_reward = {'distance_to_goal': -distance_to_goal, 'falling_penalty': -falling_penalty}
    
    return reward, individual_reward