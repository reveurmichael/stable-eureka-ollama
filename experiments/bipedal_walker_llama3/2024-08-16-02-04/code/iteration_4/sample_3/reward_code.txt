def compute_reward(self, pos, action, state):
    distance_to_goal = abs(pos[0] - TERRAIN_LENGTH)
    falling_reward = -10 if any(vel > 1 for vel in [state[i] * FPS / SCALE for i in range(4)]) else 0
    moving_forward_reward = -2 if distance_to_goal < 20 else 0.5
    smoothness_reward = 0.5 if all(abs(vel) < 0.5 for vel in state[3:7]) and all(abs(vel) < 0.5 for vel in state[10:]) else 0
    individual_reward = {
        'distance_to_goal': distance_to_goal,
        'falling': falling_reward,
        'moving_forward': moving_forward_reward,
        'smoothness': smoothness_reward
    }
    return -distance_to_goal + falling_reward + moving_forward_reward + smoothness_reward, individual_reward