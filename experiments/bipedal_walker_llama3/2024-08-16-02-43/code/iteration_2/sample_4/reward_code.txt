def compute_reward(self, pos, action, state):
    reward = 0.0
    individual_reward = {}
    
    # penalty for falling down or getting stuck
    if pos[0] < 0 or any(l.ground_contact for l in self.legs):
        reward -= 1.0
    else:
        # reward for moving forward and avoiding obstacles
        reward += 0.05 * (TERRAIN_LENGTH - pos[0]) / TERRAIN_STEP
        
    individual_reward['forward_progress'] = reward
    
    return reward, individual_reward