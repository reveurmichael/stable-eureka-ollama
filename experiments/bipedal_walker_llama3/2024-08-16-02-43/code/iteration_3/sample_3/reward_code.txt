def compute_reward(self, pos, action, state):
    reward = 0.0
    individual_reward = {}

    if not self.game_over and pos[0] > (TERRAIN_LENGTH - TERRAIN_GRASS) * TERRAIN_STEP:
        # Reward for reaching the end of the terrain
        reward += 1.0
        individual_reward['end_reached'] = 1.0

    if pos[0] < 0 or self.game_over:
        # Penalty for falling down or game over
        reward -= 2.0
        individual_reward['fallen_down'] = -2.0

    if not self.legs[1].ground_contact and not self.legs[3].ground_contact:
        # Reward for keeping both legs off the ground (not stuck)
        reward += 0.5
        individual_reward['both_legs_off_ground'] = 0.5

    if abs(vel.x) > 0.2:  # Check forward velocity
        # Reward for moving forward
        reward += 0.1
        individual_reward['moving_forward'] = 0.1

    return reward, individual_reward