def compute_reward(self, pos, action, state):
    forward_reward = (pos[0] - self.prev_pos[0]) / TERRAIN_STEP if not self.game_over else 0.0
    if forward_reward > 0:
        forward_reward *= np.exp(np.clip(action[0], -1, 1) / 2)
    else:
        forward_reward *= np.exp(-np.abs(action[0]) / 2)

    stable_penalty = -10 * (state[6] + state[13])
    if self.game_over:
        terminal_bonus = 100
    else:
        terminal_bonus = 0

    reward = forward_reward + stable_penalty + terminal_bonus
    individual_reward = {'forward': forward_reward, 'stable': stable_penalty, 'terminal': terminal_bonus}
    return reward, individual_reward