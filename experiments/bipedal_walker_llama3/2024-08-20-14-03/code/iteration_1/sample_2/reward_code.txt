def compute_reward(self, pos, action, state):
    vel_x = state[3]
    dist_to_goal = (pos[0] - TERRAIN_LENGTH) / TERRAIN_STEP
    
    # Reward for maximizing fitness score
    fitness_score_reward = 1.0 * np.exp(-np.abs(fitness_score))  # scale down large penalties
    
    # Reward for positive velocity
    vel_x_reward = 2.0 * np.abs(vel_x)
    
    # Reward for decreasing distance to goal
    dist_to_goal_reward = -1.5 * np.exp(-dist_to_goal / 100.0)  # scale down large distances
    
    reward = fitness_score_reward + vel_x_reward + dist_to_goal_reward
    
    individual_reward = {'fitness_score': fitness_score_reward,
                         'velocity': vel_x_reward,
                         'distance_to_goal': dist_to_goal_reward}
    
    return reward, individual_reward