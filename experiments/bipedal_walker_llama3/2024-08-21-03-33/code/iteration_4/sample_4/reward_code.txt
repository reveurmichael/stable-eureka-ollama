def compute_reward(self, pos, action, state):
    distance_to_goal = abs(pos[0] - TERRAIN_LENGTH)
    moving_forward = (pos[0] < 0 or pos[0] > TERRAIN_GRASS * TERRAIN_STEP)

    # Scaled rewards for moving forward and reaching the goal
    progress_reward = np.exp(-(distance_to_goal ** 2) / 1000)
    moving_forward_reward = 1 if moving_forward else 0.5

    # Penalty term to discourage negative fitness scores
    penalty = -0.01 * (state[6] + state[13])

    # Combine the rewards and penalties
    reward = progress_reward * moving_forward_reward + penalty

    individual_reward = {"progress": progress_reward, "moving_forward": moving_forward_reward, "penalty": penalty}

    return reward, individual_reward