def compute_reward(state, m_power, s_power, terminated):
    height = state[1]
    velocity_x = state[2]
    velocity_y = state[3]
    angle = state[4]

    if terminated:  # landing bonus
        return 100.0

    # Height penalty
    height_reward = -height / 10.0

    # Velocity penalty (horizontal and vertical)
    velocity_x_reward = -velocity_x ** 2 - velocity_y ** 2
    velocity_y_reward = -abs(velocity_y) * 5.0  # stronger y-velocity penalty

    # Angle penalty
    angle_reward = -angle ** 2

    reward = height_reward + velocity_x_reward + velocity_y_reward + angle_reward
    individual_reward = {'height': height_reward, 'velocity': velocity_x_reward + velocity_y_reward, 'angle': angle_reward}

    return reward, individual_reward